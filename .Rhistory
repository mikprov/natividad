coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress1",],
aes(x=Longtitude,y=Latitude,color=integral_relative),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[!locations$Site %in% c('Monterey','Sportfish') &
locations$method=="stress1",],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 1: short-term variability")
p1
p3 <-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress3",],
aes(x=Longtitude,y=Latitude,color=Threshold_minus_Variability),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[!locations$Site %in% c('Monterey','Sportfish') &
locations$method=="stress3",],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 3: (Threshold) - (Short-term variability)")
p3
p3 <-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress3",],
aes(x=Longtitude,y=Latitude,color=integral_relative),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[!locations$Site %in% c('Monterey','Sportfish') &
locations$method=="stress3",],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 3: (Threshold) - (Short-term variability)")
p3
p4 <-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress4",],
aes(x=Longtitude,y=Latitude,color=integral_relative),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[!locations$Site %in% c('Monterey','Sportfish'),],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 4: Thermal Performance Curve")
p4
p4 <-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress4",],
aes(x=Longtitude,y=Latitude,color=integral_relative),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[!locations$Site %in% c('Monterey','Sportfish') &
locations$method=="stress4",],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 4: Thermal Performance Curve")
p4
locations[locations$method=="stress4",]
stress_vals <- stress_vals[!stress_vals$Site %in% c("Monterey","LaJolla","Sportfish"),]
for(m in 1:length(methods)){ #step through each stress method
# min stress integral value among sites for that regression type and stress method
min_int <- min(stress_vals[stress_vals$method==methods[m],]$integral)
# max stress integral value among sites for that regression type and stress method
max_int <- max(stress_vals[stress_vals$method==methods[m],]$integral)
# relative integral value
stress_vals[stress_vals$method==methods[m],]$integral_relative <-
((stress_vals[stress_vals$method==methods[m],]$integral) - min_int) / (max_int - min_int)
}
locations <- locations[!locations$Site %in% c("LaJolla","VanDamme","Monterey","Sportfish"),]
locations <- left_join(locations,stress_vals,by='Site')
p1<-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress1",],
aes(x=Longtitude,y=Latitude,color=integral_relative),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[!locations$Site %in% c('Monterey','Sportfish') &
locations$method=="stress1",],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 1: short-term variability")
p1
locations
# ---
# Integrate daily stress into one value
methods <- unique(logger_stress$method)
site_vector <- unique(logger_stress$Site)
stress_vals <- expand.grid(site_vector,methods)
colnames(stress_vals) <- c("Site","method")
stress_vals$integral <- rep(NA,nrow(stress_vals))
stress_vals$integral_relative <- rep(NA,nrow(stress_vals))
for(m in 1:length(methods)){ # step through stress methods (1-4)
for(s in 1:length(site_vector)){ # and for each site
# integrate daily stress values
yy <- logger_stress[logger_stress$method==methods[m] &
logger_stress$Site==site_vector[s] ,]$daily_stress
yy <- yy[!is.na(yy)]
xx <- seq(from=1,to=length(yy),by=1)
stress_vals[stress_vals$method==methods[m] &
stress_vals$Site==site_vector[s],]$integral <- trapz(x=xx,y=yy)
} #close site loop
} #close stress method
stress_vals <- stress_vals[!stress_vals$Site %in% c("Monterey","LaJolla","Sportfish"),]
for(m in 1:length(methods)){ #step through each stress method
# min stress integral value among sites for that regression type and stress method
min_int <- min(stress_vals[stress_vals$method==methods[m],]$integral)
# max stress integral value among sites for that regression type and stress method
max_int <- max(stress_vals[stress_vals$method==methods[m],]$integral)
# relative integral value
stress_vals[stress_vals$method==methods[m],]$integral_relative <-
((stress_vals[stress_vals$method==methods[m],]$integral) - min_int) / (max_int - min_int)
}
locations <- read.csv("C:/Users/Mikaela/Box Sync/Hopkins_postdoc/natividad/data/Sensor_Locations_map.csv")
names(locations)[1] <- "Site"
locations <- locations[!locations$Site %in% c("LaJolla","VanDamme","Monterey","Sportfish"),]
locations <- left_join(locations,stress_vals,by='Site')
locations
p1<-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress1",],
aes(x=Longtitude,y=Latitude,color=integral_relative),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[!locations$Site %in% c('Monterey','Sportfish') &
locations$method=="stress1",],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 1: short-term variability")
p2<-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress2",],
aes(x=Longtitude,y=Latitude,color=integral_relative),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[!locations$Site %in% c('Monterey','Sportfish') &
locations$method=="stress2",],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 2: thermal limits")
p1<-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress1",],
aes(x=Longtitude,y=Latitude,color=integral_relative),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[locations$method=="stress1",],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 1: short-term variability")
p11<-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress1",],
aes(x=Longtitude,y=Latitude,color=integral_relative),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[locations$method=="stress1",],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 1: short-term variability")
p11
head(locations)
locations <- as.data.frame(locations)
p11<-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress1",],
aes(x=Longtitude,y=Latitude,color=integral_relative),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[locations$method=="stress1",],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 1: short-term variability")
locations
locations <- read.csv("C:/Users/Mikaela/Box Sync/Hopkins_postdoc/natividad/data/Sensor_Locations_map.csv")
names(locations)[1] <- "Site"
locations <- locations[!locations$Site %in% c("LaJolla","VanDamme","Monterey","Sportfish"),]
locations
locations <- left_join(locations,stress_vals,by='Site')
locations
p11<-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress1",],
aes(x=Longtitude,y=Latitude,color=integral_relative),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[locations$method=="stress1",],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 1: short-term variability")
rlang::last_error()
str(locations)
locations <- read.csv("C:/Users/Mikaela/Box Sync/Hopkins_postdoc/natividad/data/Sensor_Locations_map.csv")
str(locations)
names(locations)[1] <- "Site"
str(locations)
locations$Site <- as.character(locations$Site)
locations
str(locations)
locations <- locations[!locations$Site %in% c("LaJolla","VanDamme","Monterey","Sportfish"),]
locations <- left_join(locations,stress_vals,by='Site')
str(stress_vals)
rm(m,min_int,max_int)
stress_vals$Site <- as.character(stress_vals$Site)
stress_vals
locations <- read.csv("C:/Users/Mikaela/Box Sync/Hopkins_postdoc/natividad/data/Sensor_Locations_map.csv")
names(locations)[1] <- "Site"
locations$Site <- as.character(locations$Site)
locations <- locations[!locations$Site %in% c("LaJolla","VanDamme","Monterey","Sportfish"),]
locations <- left_join(locations,stress_vals,by='Site')
p11<-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress1",],
aes(x=Longtitude,y=Latitude,color=integral_relative),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[locations$method=="stress1",],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 1: short-term variability")
locations
str(locations)
locations <- read.csv("C:/Users/Mikaela/Box Sync/Hopkins_postdoc/natividad/data/Sensor_Locations_map.csv")
names(locations)[1] <- "Site"
locations$Site <- as.character(locations$Site)
locations <- left_join(locations,stress_vals,by='Site')
locations
p11<-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress1",],
aes(x=Longtitude,y=Latitude,color=integral_relative),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[locations$method=="stress1",],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 1: short-term variability")
# ---
# Integrate daily stress into one value
methods <- unique(logger_stress$method)
site_vector <- unique(logger_stress$Site)
stress_vals <- expand.grid(site_vector,methods)
colnames(stress_vals) <- c("Site","method")
stress_vals$integral <- rep(NA,nrow(stress_vals))
stress_vals$integral_relative <- rep(NA,nrow(stress_vals))
for(m in 1:length(methods)){ # step through stress methods (1-4)
for(s in 1:length(site_vector)){ # and for each site
# integrate daily stress values
yy <- logger_stress[logger_stress$method==methods[m] &
logger_stress$Site==site_vector[s] ,]$daily_stress
yy <- yy[!is.na(yy)]
xx <- seq(from=1,to=length(yy),by=1)
stress_vals[stress_vals$method==methods[m] &
stress_vals$Site==site_vector[s],]$integral <- trapz(x=xx,y=yy)
} #close site loop
} #close stress method
stress_vals <- stress_vals[!stress_vals$Site %in% c("Monterey","LaJolla","Sportfish"),]
for(m in 1:length(methods)){ #step through each stress method
# min stress integral value among sites for that regression type and stress method
min_int <- min(stress_vals[stress_vals$method==methods[m],]$integral)
# max stress integral value among sites for that regression type and stress method
max_int <- max(stress_vals[stress_vals$method==methods[m],]$integral)
# relative integral value
stress_vals[stress_vals$method==methods[m],]$integral_relative <-
((stress_vals[stress_vals$method==methods[m],]$integral) - min_int) / (max_int - min_int)
}
stress_vals$Site <- as.character(stress_vals$Site)
locations <- read.csv("C:/Users/Mikaela/Box Sync/Hopkins_postdoc/natividad/data/Sensor_Locations_map.csv")
names(locations)[1] <- "Site"
locations$Site <- as.character(locations$Site)
locations <- locations[!locations$Site %in% c("LaJolla","VanDamme","Monterey","Sportfish"),]
locations <- left_join(locations,stress_vals,by='Site')
locations$Site <- as.factor(locations$Site)
p11<-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress1",],
aes(x=Longtitude,y=Latitude,color=integral_relative),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[locations$method=="stress1",],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 1: short-term variability")
p11<-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5))
# get the shapefile
f <- st_read("C:/Users/Mikaela/Documents/GitHub/natividad/shapefiles/FEDECOOP.shp")
s <- st_read("C:/Users/Mikaela/Documents/GitHub/natividad/shapefiles/countries.shp")
ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5))
rm(p1)
p1<-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress1",],
aes(x=Longtitude,y=Latitude,color=integral_relative),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[locations$method=="stress1",],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 1: short-term variability")
p1
p1<-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress1",],
aes(x=Longtitude,y=Latitude,color=integral_relative),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[locations$method=="stress1",],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 1: short-term variability")
p2<-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress2",],
aes(x=Longtitude,y=Latitude,color=integral_relative),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[locations$method=="stress2",],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 2: thermal limits")
p3 <-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress3",],
aes(x=Longtitude,y=Latitude,color=integral_relative),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[locations$method=="stress3",],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 3: (Threshold) - (Short-term variability)")
p4 <-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress4",],
aes(x=Longtitude,y=Latitude,color=integral_relative),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[locations$method=="stress4",],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 4: Thermal Performance Curve")
jpeg(file="C:/Users/Mikaela/Documents/GitHub/natividad/figs/4map_stress_methods.jpeg",
resolution=300,units="in",width = 8,height=10)
jpeg(file="C:/Users/Mikaela/Documents/GitHub/natividad/figs/4map_stress_methods.jpeg",
unit="in",width = 8,height=10)
jpeg(file="C:/Users/Mikaela/Documents/GitHub/natividad/figs/4map_stress_methods.jpeg",
res=300,unit="in",width = 8,height=10)
plot_grid(p1,p2,p3,p4,nrow=2)
dev.off()
plots <- arrangeGrob(p1, p2, p3, p4, nrow=2)
jpeg(file="C:/Users/Mikaela/Documents/GitHub/natividad/figs/4map_stress_methods.jpeg",
res=300,unit="in",width = 8,height=10)
grid.arrange(plots)
dev.off()
p4 <-ggplot() +
geom_sf(data=s) +
geom_sf(data=f,col='grey60',fill='grey',alpha=0.3) +
coord_sf(ylim=c(26,29), xlim=c(-116,-112.5)) +
geom_point(data=locations[locations$method=="stress4",],
aes(x=Longtitude,y=Latitude,color=integral_relative),size=5) +
scale_color_viridis(direction = -1) +
geom_text_repel(data=locations[locations$method=="stress4",],
aes(x=Longtitude, y=Latitude,label = Site,color=integral_relative),
segment.color = "grey30",
size = 4,
na.rm = TRUE,
nudge_x = -0.2,
box.padding = 1) +
theme_bw() +
labs(x="",y="",color="Relative\nstress",title="Map 4: Thermal Performance Curve") +
theme(plot.margin=grid::unit(c(0,0,0,0), "mm"))
p4
rm(plots)
jpeg(file="C:/Users/Mikaela/Documents/GitHub/natividad/figs/4map_stress_methods1.jpeg",
res=300,unit="in",width = 6,height=5)
p1
dev.off()
jpeg(file="C:/Users/Mikaela/Documents/GitHub/natividad/figs/4map_stress_methods2.jpeg",
res=300,unit="in",width = 6,height=5)
p2
dev.off()
jpeg(file="C:/Users/Mikaela/Documents/GitHub/natividad/figs/4map_stress_methods3.jpeg",
res=300,unit="in",width = 6,height=5)
p3
dev.off()
jpeg(file="C:/Users/Mikaela/Documents/GitHub/natividad/figs/4map_stress_methods4.jpeg",
res=300,unit="in",width = 6,height=5)
p4
dev.off()
